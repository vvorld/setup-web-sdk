/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./src/index.js":
/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/
/***/ (() => {

eval("const defaultOptions = {\n  metadata: {},\n  containerId: 'getid-component',\n  profile: [],\n  apiUrl: '',\n  sdkKey: '',\n  flowName: 'sdk-v6'\n};\nconst defaultV5fields = [{\n  label: 'First Name',\n  type: 'text',\n  name: 'First name',\n  required: false,\n  value: '',\n  mask: {\n    regexp: '^[a-zA-Z0-9 ]+$',\n    translate: 'Form_only_latin',\n    message: 'Only latin symbols'\n  }\n}, {\n  label: 'Last Name',\n  type: 'text',\n  name: 'Last name',\n  required: false,\n  value: '',\n  mask: {\n    regexp: '^[a-zA-Z0-9 ]+$',\n    translate: 'Form_only_latin',\n    message: 'Only latin symbols'\n  }\n}, {\n  label: 'Date Of Birth',\n  type: 'date',\n  name: 'Date of birth',\n  required: true\n}, {\n  label: 'Select example',\n  type: 'select',\n  options: [{\n    name: 'H11',\n    val: '11',\n    translate: 'select_1'\n  }, {\n    name: 'H22',\n    val: '22',\n    translate: 'select_2'\n  }],\n  name: 'select example',\n  required: false\n}, {\n  type: 'file',\n  name: 'Test field file',\n  required: false\n}, {\n  label: 'I have read and understand <a href=\"https://getid.ee\">Terms of use</a> of GetID&nbspOÃœ.',\n  translate: 'consent',\n  type: 'consent',\n  name: 'privacy1'\n}];\nconst defaultV5Flow = [{\n  component: 'DocumentPhoto',\n  showRules: true,\n  interactive: true,\n  enableCheckPhoto: true,\n  country: 'ee',\n  documentType: 'id-card'\n}, {\n  component: 'Form'\n}, {\n  component: 'Record',\n  phrases: ['My name is...', 'I would like to receive a certificate...']\n}, {\n  component: 'Liveness'\n}, {\n  component: 'Selfie',\n  showRules: true,\n  enableCheckPhoto: true\n}, {\n  component: 'ThankYou'\n}];\nconst defaultCallbacks = {\n  onComplete(dataOnComplete) {\n    console.log('onComplete', dataOnComplete);\n  },\n\n  onBack() {\n    console.log('onBack');\n  },\n\n  onFail(error) {\n    console.log('onFail', error);\n  },\n\n  onVerificationComplete(data) {\n    console.log('onVerificationComplete', data);\n  },\n\n  acceptableDocuments: (supportedCountry, supportedDocs) => {\n    if (supportedCountry.length > 0 && supportedDocs.length > 0) {\n      return supportedDocuments => supportedDocuments.filter(({\n        country\n      }) => supportedCountry.includes(country.toLowerCase())).map(({\n        country,\n        documentTypes\n      }) => ({\n        country,\n        documentTypes: documentTypes.filter(v => supportedDocs.includes(v))\n      }));\n    }\n\n    if (supportedCountry.length > 0 && supportedDocs.length === 0) {\n      return supportedDocuments => supportedDocuments.filter(({\n        country\n      }) => supportedCountry.includes(country.toLowerCase()));\n    }\n\n    return supportedDocuments => supportedDocuments.map(({\n      country,\n      documentTypes\n    }) => ({\n      country,\n      documentTypes: documentTypes.filter(v => supportedDocs.includes(v))\n    }));\n  }\n};\nconst enrichBySpecialKey = {\n  mode: (config, node) => node.checked ? { ...config,\n    mode: 'popup'\n  } : config,\n  profile: config => config,\n  onComplete: (config, node) => node.checked ? { ...config,\n    onComplete: defaultCallbacks.onComplete\n  } : config,\n  onFail: (config, {\n    checked\n  }) => checked ? { ...config,\n    onFail: defaultCallbacks.onFail\n  } : config,\n  onVerificationComplete: (config, {\n    checked\n  }) => checked ? { ...config,\n    onVerificationComplete: defaultCallbacks.onVerificationComplete\n  } : config,\n  onBack: (config, {\n    checked\n  }) => checked ? { ...config,\n    onBack: defaultCallbacks.onBack\n  } : config,\n  themeModeLight: (config, {\n    checked\n  }) => checked ? { ...config,\n    themeMode: 'light'\n  } : config,\n  themeModeDark: (config, {\n    checked\n  }) => checked ? { ...config,\n    themeMode: 'dark'\n  } : config,\n  themeMode: (config, {\n    checked\n  }) => checked ? { ...config,\n    themeMode: undefined\n  } : config\n};\n\nconst getMetadataFromForm = formNodes => {\n  const externalId = formNodes.find(({\n    id\n  }) => id === 'externalId');\n  const labelKey = formNodes.find(({\n    id\n  }) => id === 'labelKey');\n  const labelValue = formNodes.find(({\n    id\n  }) => id === 'labelValue');\n  const result = {};\n  if (externalId) result.externalId = externalId.value;\n  if (labelKey && labelValue) result.labels = {\n    [labelKey.value]: labelValue.value\n  };\n  return result;\n};\n\nconst getProfileFromForm = formNodes => {\n  const profileNode = formNodes.find(({\n    id\n  }) => id === 'profile');\n\n  if (!profileNode || !profileNode.checked) {\n    return [];\n  }\n\n  return formNodes.filter(({\n    name\n  }) => name.startsWith('profile_')).map(({\n    name,\n    value\n  }) => {\n    const category = name.replace(/profile_/, '');\n    return {\n      category,\n      value\n    };\n  });\n};\n\nconst patchConfigAcceptableDocuments = (config, formNodes) => {\n  const supportedCountry = formNodes.reduce((acc, node) => {\n    if (!node.id.startsWith('supportedCountry') || !node.checked) return acc;\n    const country = node.id.replace('supportedCountry_', '');\n    return [...acc, country];\n  }, []);\n  const supportedDocs = formNodes.reduce((acc, node) => {\n    if (!node.id.startsWith('supportedDocs') || !node.checked) return acc;\n    const docType = node.id.replace('supportedDocs_', '').replace(/[A-Z]/g, letter => `-${letter.toLowerCase()}`);\n    return [...acc, docType];\n  }, []);\n  if (supportedCountry.length === 0 && supportedDocs.length === 0) return config;\n  return { ...config,\n    acceptableDocuments: defaultCallbacks.acceptableDocuments(supportedCountry, supportedDocs)\n  };\n};\n\nconst configKeys = new Set(['containerId', 'locale', 'apiUrl', 'sdkKey', 'flowName', 'customerId', 'jwt', 'injectCSS', 'styles']);\n\nconst loadSdkScript = (sdkVersion, cb) => {\n  const script = document.createElement('script');\n  script.src = `https://cdn.getid.cloud/sdk/getid-web-sdk-${sdkVersion}.min.js`;\n\n  script.onerror = err => {\n    console.error(err);\n    document.querySelector('#sdkVersion').classList.add('is-invalid');\n  };\n\n  document.body.appendChild(script);\n\n  script.onload = () => {\n    document.querySelector('#sdkVersion').classList.remove('is-invalid');\n    cb().then(res => {\n      if (res !== null && res !== void 0 && res.changeThemeMode) {\n        const switchTheme = document.getElementById('switch-theme');\n        switchTheme.addEventListener('change', ({\n          target\n        }) => {\n          res.changeThemeMode(target.checked ? 'dark' : 'light');\n        });\n      }\n    }).catch(console.error);\n  };\n};\n\ndocument.querySelector('#form-setting').addEventListener('submit', event => {\n  var _find;\n\n  event.preventDefault();\n  const {\n    target\n  } = event;\n  const formResult = [...target].filter(({\n    value\n  }) => value);\n  const config = formResult.reduce((acc, node) => {\n    if (configKeys.has(node.id) && node.value) {\n      return { ...acc,\n        [node.id]: node.value\n      };\n    }\n\n    if (node.id in enrichBySpecialKey) {\n      return enrichBySpecialKey[node.id](acc, node);\n    }\n\n    return acc;\n  }, defaultOptions);\n  const metadata = getMetadataFromForm(formResult);\n  const profile = getProfileFromForm(formResult);\n  const initConfig = { ...patchConfigAcceptableDocuments(config, formResult),\n    metadata,\n    profile\n  };\n  console.log('initConfig', initConfig);\n\n  const initCallback = () => window.getidWebSdk.init(initConfig);\n\n  loadSdkScript(((_find = [...formResult].find(({\n    id\n  }) => id === 'sdkVersion')) === null || _find === void 0 ? void 0 : _find.value) || 'v6', initCallback);\n});\ndocument.querySelector('#v5-form-setting').addEventListener('submit', event => {\n  event.preventDefault();\n  const {\n    target\n  } = event;\n  const formResult = [...target].filter(({\n    value\n  }) => value);\n  const formFields = formResult.filter(({\n    name,\n    checked\n  }) => name === 'fields' && checked === true).map(({\n    id\n  }) => id);\n  const normalizedFields = defaultV5fields.filter(({\n    name\n  }) => formFields.includes(name));\n  const flowFromForm = formResult.filter(({\n    name,\n    checked\n  }) => name === 'flows' && checked === true).map(({\n    id\n  }) => id);\n  const normalizedFlow = defaultV5Flow.reduce((acc, component) => {\n    if (flowFromForm.includes(component.component)) {\n      if (component.component !== 'Form') {\n        return [...acc, component];\n      }\n\n      return [...acc, { ...component,\n        fields: normalizedFields\n      }];\n    }\n\n    return acc;\n  }, []);\n  const callbacksForm = formResult.filter(({\n    name,\n    checked\n  }) => name === 'callback' && checked === true).map(({\n    value\n  }) => value);\n  const callBacks = callbacksForm // eslint-disable-next-line max-len\n  .reduce((acc, callbackName) => ({ ...acc,\n    [callbackName]: defaultCallbacks[callbackName]\n  }), {});\n  const apiUrl = document.querySelector('#apiUrl-v5').value;\n  const sdkKey = document.querySelector('#sdkKey-v5').value;\n  const sdkVersion = document.querySelector('#sdkVersion-v5').value;\n  const verificationTypes = ['data-extraction'];\n\n  if (flowFromForm.includes('Selfie')) {\n    verificationTypes.push('face-matching');\n  }\n\n  if (flowFromForm.includes('Liveness')) {\n    verificationTypes.push('liveness');\n  }\n\n  const initConfig = { ...callBacks,\n    flow: normalizedFlow,\n    apiUrl,\n    containerId: 'getid-component',\n    verificationTypes\n  };\n  console.log('initConfig', initConfig);\n\n  const initCallback = () => window.getidWebSdk.init(initConfig, sdkKey);\n\n  loadSdkScript(sdkVersion || 'v5', initCallback);\n});\nconst profileCheckbox = document.querySelector('#profile');\nconst formsProfile = document.querySelectorAll('input[name^=\"profile\"][type=\"text\"]');\nprofileCheckbox.addEventListener('change', ({\n  target\n}) => {\n  formsProfile.forEach(el => {\n    // eslint-disable-next-line no-param-reassign\n    el.disabled = !target.checked;\n  });\n});\n$('.checkbox-menu').on('change', \"input[type='checkbox']\", function () {\n  $(this).closest('li').toggleClass('active', this.checked);\n});\n$(document).on('click', '.allow-focus', e => {\n  e.stopPropagation();\n});\n\n//# sourceURL=webpack://test_sdk_versions/./src/index.js?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = {};
/******/ 	__webpack_modules__["./src/index.js"]();
/******/ 	
/******/ })()
;